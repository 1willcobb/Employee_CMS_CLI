-- SELECT ALL EMPOLOYEES
SELECT *
FROM employees JOIN roles ON roles.id = employees.role_id;

SELECT 
    employees.first_name, 
    employees.last_name, 
    roles.title, 
    department.name, 
    (SELECT first_name
    FROM employees AS manager
    WHERE manager.id = employees.manager_id) 
    AS Manager
FROM employees 
JOIN roles ON roles.id = employees.role_id 
JOIN department ON department.id = roles.department_id;

SELECT 
    employees.first_name, 
    employees.last_name, 
    roles.title, 
    department.name, 
    CONCAT(manager.first_name, ' ', manager.last_name) AS Manager
FROM employees 
JOIN roles ON roles.id = employees.role_id 
JOIN department ON department.id = roles.department_id
JOIN employees AS manager ON manager.id = employees.manager_id;

--VIEW Employees combined Table
SELECT 
    employees.id, 
    employees.first_name AS "First Name", 
    employees.last_name AS "Last Name", 
    roles.title AS "Job Title", 
    department.name AS "Department", 
    roles.salary AS "Salary", 
    (SELECT CONCAT(manager.first_name, " ", manager.last_name) 
        FROM employees AS manager 
        WHERE manager.id = employees.manager_id) 
        AS "Ranking Manger" 
FROM employees 
JOIN roles ON roles.id = employees.role_id 
JOIN department ON department.id = roles.department_id

--View employees by manager:
SELECT 
    employees.first_name,
    manager.first_name
FROM employees
JOIN roles ON roles.id = employees.role_id 
JOIN department ON department.id = roles.department_id
JOIN employees AS manager ON manager.id = employees.manager_id
WHERE manager.id = 0;

--Sort by org chart
SELECT 
    employees.id, 
    employees.first_name AS "First Name", 
    employees.last_name AS "Last Name", 
    roles.title AS "Job Title", 
    department.name AS "Department", 
    roles.salary AS "Salary", 
    (SELECT CONCAT(manager.first_name, " ", manager.last_name) 
        FROM employees AS manager 
        WHERE manager.id = employees.manager_id) 
        AS "Ranking Manger",
    roles.org_id
FROM employees 
JOIN roles ON roles.id = employees.role_id 
JOIN department ON department.id = roles.department_id
ORDER BY roles.org_id;



UPDATE employees
SET manager_id = ?
WHERE employees.manager_id = 
    (SELECT manager.id 
    FROM employees AS manager
    WHERE manger.id = )